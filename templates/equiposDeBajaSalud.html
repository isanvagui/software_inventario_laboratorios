{% extends 'layout.html' %}

{% block title %}Modulo Salud{% endblock %}

{% block body %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
<link rel="stylesheet" href="https://bootswatch.com/5/materia/bootstrap.min.css">
<link rel="stylesheet" href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.min.css">
<link rel="stylesheet" href="{{ url_for('static', filename='css/indexSalud.css') }}">
<div class="container-salud">
    <div class="container-indexSalud">
        <div class="row">

            <!-- Tabla de visualización de productos -->
            <div class="col-md-12">
                <div class="table-container">
                    <div class="table-responsive">
                        <table id="tabla" class="table table-striped table-bordered bg-white table-sm"> 
                            <thead>
                                <tr>
                                    <th>Codigo Equipo</th>
                                    <th title="Fecha de ingreso del equipo a la institución">Fecha ingreso</th>
                                    <th>Fecha de baja</th>
                                    <th>Nombre de equipo</th>
                                    <th>Estado equipo</th>
                                    <th>Ubicación original</th>
                                    <th>Proveedor de Venta</th>
                                    <th>Acción</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for producto in equipos_de_baja %}
                                <tr>
                                    <td>
                                        <input 
                                            type="checkbox" 
                                            class="equipo-checkbox"
                                            data-codigo="{{ producto.cod_articulo }}" 
                                            data-nombre="{{ producto.nombre_equipo }}">

                                        <span>{{ producto.cod_articulo }}</span>
                                    </td>
                                    
                                    <td>{{ producto.fecha_ingreso }}</td>
                                    <td>{{ producto.fecha_de_baja }}</td>
                                    <td>{{ producto.nombre_equipo }}</td>

                                    <td>
                                        <form action="/update_estado_equipo" method="POST">
                                            <input type="hidden" name="csrf_token" value="{{csrf_token()}}">
                                            <select name="nuevo_estado_equipo">
                                                {% for estadoEquipo in estadoEquipos %}
                                                <option value="{{ estadoEquipo.estado_equipo }}" {% if producto.estado_equipo == estadoEquipo.estado_equipo %}selected{% endif %}>
                                                    {{ estadoEquipo.estado_equipo }}
                                                </option>
                                                {% endfor %}
                                            </select>
                                        </form>
                                    </td>
                                    <td>{{ producto.ubicacion_original }}</td>

                                    <td>
                                        <div class="btn-eliminar">
                                            <a href="{{ url_for('inventario.datosProveedorSalud', id=producto.proveedor_responsable) }}" class="btn btn-tabla btn-lg">
                                                <FONT SIZE=3>datos</FONT>
                                            </a>
                                        </div>
                                    </td>

                                    <td>
                                        <div class="text-center mt-2">
                                            <a href="{{ url_for('inventario.GET_PRODUCTO_SALUD', id=producto['id'], vista='equiposDeBajaSalud') }}" class="btn btn-secondary btn-sm"><FONT SIZE=2>Editar/Ver hoja de vida</FONT></a>
                                        </div>

                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>                         
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>

<!-- boton de busqueda y filtro, con lenguaje en español -->
<script>
    $("#tabla").DataTable({
        "language": {
            "url": "https://cdn.datatables.net/plug-ins/1.13.6/i18n/es-ES.json"
        }
    }

    );

</script>

<script>
  const csrf_token = "{{ csrf_token() }}";
</script>

{% endblock %}
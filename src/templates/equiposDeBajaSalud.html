{% extends 'layout.html' %}

{% block title %}Modulo Salud{% endblock %}

{% block body %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
<link rel="stylesheet" href="https://bootswatch.com/5/materia/bootstrap.min.css">
<link rel="stylesheet" href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.min.css">
<link rel="stylesheet" href="{{ url_for('static', filename='css/indexSalud.css') }}">
<div class="container-salud">
    <div class="container-indexSalud">
        <div class="row">

            <!-- Tabla de visualización de productos -->
            <div class="col-md-12">
                <div class="table-container">
                    <div class="table-responsive">
                        <table class="table table-striped table-bordered bg-white table-sm" id="tabla">
                            <thead>
                                <tr>
                                    <td>Codigo Articulo</td>
                                    <td>Nombre de equipo</td>
                                    <td>Periodicidad mantenimineto (Meses)</td>
                                    <td>Programación mantenimiento</td>
                                    <td>Periodicidad calibración (Meses)</td>
                                    <td>Programación calibración</td>
                                    <td>Fecha ingreso</td>
                                    <td>Estado equipo</td>
                                    <td>Ubicación original</td>
                                    <td>Garantía ingreso</td>
                                    <td>Criticos</td>
                                    <td>Proveedor responsable</td>
                                    <td>Semaforo mantenimiento</td>
                                    <td>Acción</td>
                                </tr>
                            </thead>
                            <tbody>
                                {% for producto in equipos_de_baja %}
                                <tr>
                                    <td>{{ producto.cod_articulo }}</td>
                                    <td>{{ producto.nombre_equipo }}</td>
                                    <td>{{ producto.periodicidad }}</td>
                                    <td>{{ producto.fecha_mantenimiento }}
                                        <input type="checkbox" name="fecha_mantenimiento" 
                                        data-producto-id="{{ producto.id }}" data-estado-inicial="{{ producto.checkbox_mantenimiento }}" 
                                        {% if producto.checkbox_mantenimiento == 'Activo' %}checked{% endif %}>

                                    </td>

                                    <td>{{ producto.periodicidad_calibracion }}</td>
                                    
                                    <td>{{ producto.fecha_calibracion }}
                                        <input type="checkbox" name="fecha_calibracion"
                                            data-producto-id="{{ producto.id }}" data-estado-inicial="{{ producto.checkbox_calibracion }}"
                                            {% if producto.checkbox_calibracion=='Activo' %}checked{% endif %}>
                                    </td>
                                    <td>{{ producto.fecha_ingreso }}</td>
                                    <td>
                                        <form action="/update_estado_equipo" method="POST">
                                            <input type="hidden" name="csrf_token" value="{{csrf_token()}}">
                                            <select name="nuevo_estado_equipo">
                                                {% for estadoEquipo in estadoEquipos %}
                                                <option value="{{ estadoEquipo.estado_equipo }}" {% if producto.estado_equipo == estadoEquipo.estado_equipo %}selected{% endif %}>
                                                    {{ estadoEquipo.estado_equipo }}
                                                </option>
                                                {% endfor %}
                                            </select>
                                            <!-- <button type="submit" name="guardar_estado" class="btn-indexSalud">Guardar</button> -->
                                        </form>
                                    </td>
                                    <td>{{ producto.ubicacion_original }}</td>
                                    <td>{{ producto.garantia }}</td>
                                    <td>
                                        {% if producto.criticos == "si" %}
                                        <i class="bi bi-radioactive"></i>
                                        {% else %}
                                        <i class="bi bi-shield-check"></i>
                                        {% endif %}
                                    </td>
                                    <td>
                                        <div class="btn-eliminar">
                                            <a href="/datosProveedorSalud/{{ producto.proveedor_responsable }}" class="btn btn-tabla btn-lg">
                                                <FONT SIZE=3>datos</FONT>
                                            </a>
                                        </div>
                                    </td>
                                    <td class="semaforo"
                                        style="width: 50px; border-radius: 50%; height: 50px; background-color: {% if producto.color == 'purple' %}purple{% elif producto.color == 'red' %}red{% elif producto.color == 'yellow' %}yellow{% else %}green{% endif %}">
                                    </td>
                                    <td>
                                        <div class="btn-eliminar">
                                            <!-- <a href="/edit_productoSalud/{{producto.id}}"
                                                class="btn btn-secondary btn-sm">
                                                <FONT SIZE=2>Editar/Ver hoja de vida</FONT>
                                            </a> -->
                                            <a href="{{ url_for('GET_PRODUCTO_SALUD', id=producto['id'], vista='equiposDeBajaSalud') }}" class="btn btn-secondary btn-sm"><FONT SIZE=2>Editar/Ver hoja de vida</FONT></a>
                                        </div>
                                        <br>
                                        <div class="btn-eliminar">
                                            <a href="/delete_productoSalud/{{producto.id}}" class="btn btn-tabla btn-lg" >
                                                <FONT SIZE=3>Eliminar</FONT>
                                            </a>
                                        </div>
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>

<!-- boton de busqueda y filtro, con lenguaje en español -->
<script>
    $("#tabla").DataTable({
        "language": {
            "url": "//cdn.datatables.net/plug-ins/1.10.15/i18n/Spanish.json"
        }
    }

    );

</script>

<!-- Scripts para el checkbox (Para activar o desactivar manualmente desde la tabla.) -->
<script>
    var csrf_token = "{{ csrf_token() }}";
</script>

{% endblock %}